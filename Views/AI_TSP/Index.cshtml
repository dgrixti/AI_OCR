@{
    ViewData["Title"] = "AI Projects";
}

    <div class="text-center">
        <h1 class="display-4">AI Travelling Salesman Problem (Part 1)</h1>

        <p><b>Example #1 </b> with 3 cities (6 possible paths).</p>


        <div class="main_container">
            <center>
                <canvas id="drawCanvasSimple" width="750" height="200"></canvas>

                <p />

                <canvas id="canvasSimpleSolved" width="750" height="200"></canvas>
            </center>
        </div>

        <script>

            var canvasSimple = document.getElementById("drawCanvasSimple");
            var canvasSimpleSolved = document.getElementById("canvasSimpleSolved");

            function drawCircle(canvasVar, id, x, y) {
                var ctx = canvasVar.getContext("2d");

                ctx.strokeStyle = 'black';
                ctx.font = "13px Arial";
                ctx.fillText(id, x + 10, y + 10);

                ctx.beginPath();
                ctx.arc(x, y, 5, 0, 2 * Math.PI);
                ctx.stroke();
            }

            function drawLine(canvasVar, x1, y1, x2, y2) {
                var ctx = canvasVar.getContext("2d");

                ctx.strokeStyle = 'red';
                ctx.lineWidth = 1

                ctx.moveTo(x1, y1);
                ctx.lineTo(x2, y2);
                ctx.stroke();
            }

            function plotCitiesSimple() {
                var json = getCities("v1");
                //for (var i = 0; i < json.length; i++) {
                for (var i = 0; i < 4; i++) {

                    console.log("city " + i + ": ");
                    var obj = json[i];
                    // increase the space for each circle plotting
                    obj.x = obj.x * 10;
                    obj.y = obj.y * 2;

                    console.log(obj.id + ": " + obj.x + ", " + obj.y);

                    drawCircle(canvasSimple, obj.id, obj.x, obj.y);
                }
            }

            function sleep(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }

            async function plotCitiesSimpleSolved() {
                var prePoint = null;
                var json = getCities("v1");
                //for (var i = 0; i < json.length; i++) {
                for (var i = 0; i < 4; i++) {
                    console.log("city " + i + ": ");
                    var obj = json[i];
                    // increase the space for each circle plotting
                    obj.x = obj.x * 10;
                    obj.y = obj.y * 2;
                    console.log(obj.id + ": " + obj.x + ", " + obj.y);
                    // draw the points ()
                    drawCircle(canvasSimpleSolved, obj.id, obj.x, obj.y);
                }
                
                // draw the lines
                for (var i = 0; i < 4; i++) {
                    var obj = json[i];
                    if (prePoint !== null) {
                        drawLine(canvasSimpleSolved, prePoint.x, prePoint.y, obj.x, obj.y);
                    }
                    prePoint = obj;
                    await sleep("1000");
                }

                // draw the final closing point
                drawLine(canvasSimpleSolved, json[0].x, json[0].y, json[3].x, json[3].y);

            }

            function getCities(vers) {
                var dataret = "";
                $.ajax({
                    type: "POST",
                    traditional: true,
                    dataType: "json",
                    url: "/AI_TSP/GetCities",
                    data: { vers },
                    cache: false,
                    async: false, // wait for result
                    complete: function (data) {
                        if (data.responseJSON.length > 0) {
                            dataret = data.responseJSON;
                            console.log("got response");
                        }
                        else {
                            console.log("no data!");
                        }
                    }
                });

                return dataret;
            }

            setTimeout("plotCitiesSimple()", 200);
            setTimeout("plotCitiesSimpleSolved()", 200);

        </script>
    </div>
